{"file_summary": {"inferred_detail": "This script manages the daily population of the CC_AGREEMENT_ADDED_DATE table. It begins by logging its start time and clearing a temporary work table. The core logic involves calculating the initial 'added date' for credit card agreements from the main agreement history table and storing it in the work table (WK_CC_AGREEMENT_ADDED_DT_T1). It then populates the final target table (CC_AGREEMENT_ADDED_DATE) by combining data about original agreements and their traded successors from the agreement relationship table, the work table, and static agreement data. It handles accounts that exist in the relationship table and those that do not. Finally, it enriches the target table with marketing channel data (MAC, sort code, channel code) from various sources for agreements not yet in the main static table, updates the original channel data for traded accounts, cleans up the work table, and logs the successful completion of the job. Error handling is included to log failures.", "dependencies": ["C01J01", "C01J02"]}, "statements": [{"s_id": "s1", "statement_type": "UPDATE", "target_table": {"database_name": "CC_COBRA", "schema_name": null, "table_name": "CC_COBRA_LOAD_LOG", "alias": null, "inferred_target_type": "LOG_TABLE"}, "sources": [{"source_id": "src1", "database_name": "CC_COBRA", "schema_name": null, "table_name": "CC_COBRA_LOAD_STATUS", "alias": "A", "source_type": "BASE_TABLE"}], "column_lineage": [{"output_column_name": "RUN_ID", "output_column_ordinal": null, "transformation_logic": "A.RUN_ID", "source_references": [{"source_id": "src1", "column_name": "RUN_ID"}]}, {"output_column_name": "LOAD_STATUS", "output_column_ordinal": null, "transformation_logic": "'I'", "source_references": []}, {"output_column_name": "LOAD_START_DT", "output_column_ordinal": null, "transformation_logic": "DATE", "source_references": []}, {"output_column_name": "LOAD_START_TM", "output_column_ordinal": null, "transformation_logic": "TIME", "source_references": []}], "joins": [], "filters": [{"clause": "WHERE", "filter_expression": "CC_COBRA.CC_COBRA_LOAD_LOG.GRID_LOAD_ID = 'C01J02'", "involved_columns": [{"source_id": "target", "column_name": "GRID_LOAD_ID"}]}, {"clause": "WHERE", "filter_expression": "A.RUN_STATUS = 'I'", "involved_columns": [{"source_id": "src1", "column_name": "RUN_STATUS"}]}]}, {"s_id": "s2", "statement_type": "DELETE", "target_table": {"database_name": "CC_COBRA", "schema_name": null, "table_name": "WK_CC_AGREEMENT_ADDED_DT_T1", "alias": null, "inferred_target_type": "WORK_TABLE"}, "sources": [], "column_lineage": [], "joins": [], "filters": [{"clause": "WHERE", "filter_expression": "ALL", "involved_columns": []}]}, {"s_id": "s3", "statement_type": "INSERT", "target_table": {"database_name": "CC_COBRA", "schema_name": null, "table_name": "WK_CC_AGREEMENT_ADDED_DT_T1", "alias": null, "inferred_target_type": "WORK_TABLE"}, "sources": [{"source_id": "src1", "database_name": "GDW_VIEWSX", "schema_name": null, "table_name": "CREDIT_CARD_AGREEMENT", "alias": "A", "source_type": "BASE_TABLE"}, {"source_id": "src2", "database_name": "CC_COBRA", "schema_name": null, "table_name": "CC_COBRA_LOAD_START_DT", "alias": "D", "source_type": "BASE_TABLE"}, {"source_id": "src3", "database_name": "GDW_VIEWSX", "schema_name": null, "table_name": "CREDIT_CARD_AGREEMENT", "alias": "CCA", "source_type": "BASE_TABLE"}, {"source_id": "src4", "database_name": "GDW_VIEWSX", "schema_name": null, "table_name": "AGREEMENT", "alias": "B", "source_type": "BASE_TABLE"}, {"source_id": "src5", "database_name": "CC_COBRA", "schema_name": null, "table_name": "CC_VERDE_FLAG_DAILY", "alias": "V", "source_type": "BASE_TABLE"}], "column_lineage": [{"output_column_name": "ORG_TX", "output_column_ordinal": 1, "transformation_logic": "A.ORG_TX", "source_references": [{"source_id": "src1", "column_name": "ORG_TX"}]}, {"output_column_name": "V_ORG", "output_column_ordinal": 2, "transformation_logic": "CASE WHEN V.VERDE_IN IN (1,
2) THEN '170' ELSE A.ORG_TX END", "source_references": [{"source_id": "src5", "column_name": "VERDE_IN"}, {"source_id": "src1", "column_name": "ORG_TX"}]}, {"output_column_name": "AGRMNT_ID", "output_column_ordinal": 3, "transformation_logic": "A.AGRMNT_ID", "source_references": [{"source_id": "src1", "column_name": "AGRMNT_ID"}]}, {"output_column_name": "CREDIT_CARD_LOGO_CD", "output_column_ordinal": 4, "transformation_logic": "CCA.CREDIT_CARD_LOGO_CD", "source_references": [{"source_id": "src3", "column_name": "CREDIT_CARD_LOGO_CD"}]}, {"output_column_name": "ADDED_DT", "output_column_ordinal": 5, "transformation_logic": "A.ADDED_DT", "source_references": [{"source_id": "src1", "column_name": "SOURCE_START_DT"}]}, {"output_column_name": "OPENED_DT", "output_column_ordinal": 6, "transformation_logic": "B.OPENED_DT", "source_references": [{"source_id": "src4", "column_name": "OPENED_DT"}]}, {"output_column_name": "PURGED_DT", "output_column_ordinal": 7, "transformation_logic": "B.AGRMNT_EXPIRY_DT", "source_references": [{"source_id": "src4", "column_name": "AGRMNT_EXPIRY_DT"}]}], "joins": [{"join_type": "JOIN", "left_source_id": "src1", "right_source_id": "src2", "join_conditions": [{"left_source_id": "src1", "left_column": "ADDED_DT", "operator": "<=", "right_source_id": "src2", "right_column": "SOURCE_START_DT"}]}, {"join_type": "JOIN", "left_source_id": "src1", "right_source_id": "src3", "join_conditions": [{"left_source_id": "src1", "left_column": "AGRMNT_ID", "operator": "=", "right_source_id": "src3", "right_column": "AGRMNT_ID"}]}, {"join_type": "JOIN", "left_source_id": "src1", "right_source_id": "src4", "join_conditions": [{"left_source_id": "src1", "left_column": "AGRMNT_ID", "operator": "=", "right_source_id": "src4", "right_column": "AGRMNT_ID"}]}, {"join_type": "LEFT JOIN", "left_source_id": "src1", "right_source_id": "src5", "join_conditions": [{"left_source_id": "src1", "left_column": "AGRMNT_ID", "operator": "=", "right_source_id": "src5", "right_column": "AGRMNT_ID"}]}], "filters": [{"clause": "WHERE", "filter_expression": "ORG_TX <> '170'", "involved_columns": [{"source_id": "src1", "column_name": "ORG_TX"}]}, {"clause": "ON", "filter_expression": "CCA.SOURCE_END_DT = '3500/12/31'", "involved_columns": [{"source_id": "src3", "column_name": "SOURCE_END_DT"}]}, {"clause": "ON", "filter_expression": "B.SOURCE_END_DT = '3500/12/31'", "involved_columns": [{"source_id": "src4", "column_name": "SOURCE_END_DT"}]}, {"clause": "ON", "filter_expression": "V.SOURCE_END_DT = '3500/12/31'", "involved_columns": [{"source_id": "src5", "column_name": "SOURCE_END_DT"}]}]}, {"s_id": "s4", "statement_type": "DELETE", "target_table": {"database_name": "CC_COBRA", "schema_name": null, "table_name": "CC_AGREEMENT_ADDED_DATE", "alias": null, "inferred_target_type": "BASE_TABLE"}, "sources": [], "column_lineage": [], "joins": [], "filters": [{"clause": "WHERE", "filter_expression": "ALL", "involved_columns": []}]}, {"s_id": "s5", "statement_type": "INSERT", "target_table": {"database_name": "CC_COBRA", "schema_name": null, "table_name": "CC_AGREEMENT_ADDED_DATE", "alias": null, "inferred_target_type": "BASE_TABLE"}, "sources": [{"source_id": "src1", "database_name": "GDW_VIEWSX", "schema_name": null, "table_name": "AGREEMENT_RELATIONSHIP", "alias": "T1", "source_type": "BASE_TABLE"}, {"source_id": "src2", "database_name": "CC_COBRA", "schema_name": null, "table_name": "WK_CC_AGREEMENT_ADDED_DT_T1", "alias": "B", "source_type": "WORK_TABLE"}, {"source_id": "src3", "database_name": "CC_COBRA", "schema_name": null, "table_name": "WK_CC_AGREEMENT_ADDED_DT_T1", "alias": "B2", "source_type": "WORK_TABLE"}, {"source_id": "src4", "database_name": "GRIDX_DV_RETAIL", "schema_name": null, "table_name": "AGREEMENT_STATIC", "alias": "AST", "source_type": "BASE_TABLE"}, {"source_id": "src5", "database_name": "CC_COBRA_VIEWS", "schema_name": null, "table_name": "VW_CC_MIGRATION_ACCOUNTS", "alias": "M", "source_type": "BASE_TABLE"}], "column_lineage": [{"output_column_name": "ORG_TX", "output_column_ordinal": 1, "transformation_logic": "B2.ORG_TX", "source_references": [{"source_id": "src3", "column_name": "ORG_TX"}]}, {"output_column_name": "ORG_TX", "output_column_ordinal": 1, "transformation_logic": "B.ORG_TX", "source_references": [{"source_id": "src2", "column_name": "ORG_TX"}]}, {"output_column_name": "V_ORG", "output_column_ordinal": 2, "transformation_logic": "B2.V_ORG", "source_references": [{"source_id": "src3", "column_name": "V_ORG"}]}, {"output_column_name": "V_ORG", "output_column_ordinal": 2, "transformation_logic": "B.V_ORG", "source_references": [{"source_id": "src2", "column_name": "V_ORG"}]}, {"output_column_name": "AGRMNT_ID", "output_column_ordinal": 3, "transformation_logic": "T1.AGRMNT_ID", "source_references": [{"source_id": "src1", "column_name": "AGRMNT_ID"}]}, {"output_column_name": "AGRMNT_ID", "output_column_ordinal": 3, "transformation_logic": "T1.ORIGNL_AGRMNT_ID", "source_references": [{"source_id": "src1", "column_name": "ORIGNL_AGRMNT_ID"}]}, {"output_column_name": "ORIGNL_AGRMNT_ID", "output_column_ordinal": 4, "transformation_logic": "T1.ORIGNL_AGRMNT_ID", "source_references": [{"source_id": "src1", "column_name": "ORIGNL_AGRMNT_ID"}]}, {"output_column_name": "ORIGNL_AGRMNT_ID", "output_column_ordinal": 4, "transformation_logic": "T1.ORIGNL_AGRMNT_ID", "source_references": [{"source_id": "src1", "column_name": "ORIGNL_AGRMNT_ID"}]}, {"output_column_name": "AGRMNT_RLTNSP_SEQUNC_NO", "output_column_ordinal": 5, "transformation_logic": "T1.AGRMNT_RLTNSP_SEQUNC_NO", "source_references": [{"source_id": "src1", "column_name": "AGRMNT_RLTNSP_SEQUNC_NO"}]}, {"output_column_name": "AGRMNT_RLTNSP_SEQUNC_NO", "output_column_ordinal": 5, "transformation_logic": "0", "source_references": []}, {"output_column_name": "CREDIT_CARD_LOGO_CD", "output_column_ordinal": 6, "transformation_logic": "B2.CREDIT_CARD_LOGO_CD", "source_references": [{"source_id": "src3", "column_name": "CREDIT_CARD_LOGO_CD"}]}, {"output_column_name": "CREDIT_CARD_LOGO_CD", "output_column_ordinal": 6, "transformation_logic": "B.CREDIT_CARD_LOGO_CD", "source_references": [{"source_id": "src2", "column_name": "CREDIT_CARD_LOGO_CD"}]}, {"output_column_name": "ADDED_DT", "output_column_ordinal": 7, "transformation_logic": "COALESCE(M.ACC_BUILD_DT,B2.ADDED_DT)", "source_references": [{"source_id": "src5", "column_name": "ACC_BUILD_DT"}, {"source_id": "src3", "column_name": "ADDED_DT"}]}, {"output_column_name": "ADDED_DT", "output_column_ordinal": 7, "transformation_logic": "COALESCE(M.ACC_BUILD_DT,B.ADDED_DT)", "source_references": [{"source_id": "src5", "column_name": "ACC_BUILD_DT"}, {"source_id": "src2", "column_name": "ADDED_DT"}]}, {"output_column_name": "ORIGNL_ADDED_DT", "output_column_ordinal": 8, "transformation_logic": "COALESCE(M.ACC_OPEN_DT,B.ADDED_DT)", "source_references": [{"source_id": "src5", "column_name": "ACC_OPEN_DT"}, {"source_id": "src2", "column_name": "ADDED_DT"}]}, {"output_column_name": "ORIGNL_ADDED_DT", "output_column_ordinal": 8, "transformation_logic": "COALESCE(M.ACC_OPEN_DT,B.ADDED_DT)", "source_references": [{"source_id": "src5", "column_name": "ACC_OPEN_DT"}, {"source_id": "src2", "column_name": "ADDED_DT"}]}, {"output_column_name": "OPENED_DT", "output_column_ordinal": 9, "transformation_logic": "B2.OPENED_DT", "source_references": [{"source_id": "src3", "column_name": "OPENED_DT"}]}, {"output_column_name": "OPENED_DT", "output_column_ordinal": 9, "transformation_logic": "B.OPENED_DT", "source_references": [{"source_id": "src2", "column_name": "OPENED_DT"}]}, {"output_column_name": "PURGED_DT", "output_column_ordinal": 10, "transformation_logic": "B2.PURGED_DT", "source_references": [{"source_id": "src3", "column_name": "PURGED_DT"}]}, {"output_column_name": "PURGED_DT", "output_column_ordinal": 10, "transformation_logic": "B.PURGED_DT", "source_references": [{"source_id": "src2", "column_name": "PURGED_DT"}]}, {"output_column_name": "AGRMNT_SELLNG_SORT_CD", "output_column_ordinal": 11, "transformation_logic": "AST.AGRMNT_SELLNG_SORT_CD", "source_references": [{"source_id": "src4", "column_name": "AGRMNT_SELLNG_SORT_CD"}]}, {"output_column_name": "AGRMNT_SELLNG_SORT_CD", "output_column_ordinal": 11, "transformation_logic": "AST.AGRMNT_SELLNG_SORT_CD", "source_references": [{"source_id": "src4", "column_name": "AGRMNT_SELLNG_SORT_CD"}]}, {"output_column_name": "MAC_CD", "output_column_ordinal": 12, "transformation_logic": "AST.MAC_CD", "source_references": [{"source_id": "src4", "column_name": "MAC_CD"}]}, {"output_column_name": "MAC_CD", "output_column_ordinal": 12, "transformation_logic": "AST.MAC_CD", "source_references": [{"source_id": "src4", "column_name": "MAC_CD"}]}, {"output_column_name": "AGRMNT_SELLNG_CHANNL_CD", "output_column_ordinal": 13, "transformation_logic": "AST.AGRMNT_SELLNG_CHANNL_CD", "source_references": [{"source_id": "src4", "column_name": "AGRMNT_SELLNG_CHANNL_CD"}]}, {"output_column_name": "AGRMNT_SELLNG_CHANNL_CD", "output_column_ordinal": 13, "transformation_logic": "AST.AGRMNT_SELLNG_CHANNL_CD", "source_references": [{"source_id": "src4", "column_name": "AGRMNT_SELLNG_CHANNL_CD"}]}, {"output_column_name": "ORIGNL_AGRMNT_SELLNG_SORT_CD", "output_column_ordinal": 14, "transformation_logic": "AST.AGRMNT_SELLNG_SORT_CD", "source_references": [{"source_id": "src4", "column_name": "AGRMNT_SELLNG_SORT_CD"}]}, {"output_column_name": "ORIGNL_AGRMNT_SELLNG_SORT_CD", "output_column_ordinal": 14, "transformation_logic": "AST.AGRMNT_SELLNG_SORT_CD", "source_references": [{"source_id": "src4", "column_name": "AGRMNT_SELLNG_SORT_CD"}]}, {"output_column_name": "ORIGNL_MAC_CD", "output_column_ordinal": 15, "transformation_logic": "AST.MAC_CD", "source_references": [{"source_id": "src4", "column_name": "MAC_CD"}]}, {"output_column_name": "ORIGNL_MAC_CD", "output_column_ordinal": 15, "transformation_logic": "AST.MAC_CD", "source_references": [{"source_id": "src4", "column_name": "MAC_CD"}]}, {"output_column_name": "ORIGNL_AGRMNT_SELLNG_CHANNL_CD", "output_column_ordinal": 16, "transformation_logic": "AST.AGRMNT_SELLNG_CHANNL_CD", "source_references": [{"source_id": "src4", "column_name": "AGRMNT_SELLNG_CHANNL_CD"}]}, {"output_column_name": "ORIGNL_AGRMNT_SELLNG_CHANNL_CD", "output_column_ordinal": 16, "transformation_logic": "AST.AGRMNT_SELLNG_CHANNL_CD", "source_references": [{"source_id": "src4", "column_name": "AGRMNT_SELLNG_CHANNL_CD"}]}], "joins": [{"join_type": "JOIN", "left_source_id": "src1", "right_source_id": "src2", "join_conditions": [{"left_source_id": "src1", "left_column": "ORIGNL_AGRMNT_ID", "operator": "=", "right_source_id": "src2", "right_column": "AGRMNT_ID"}]}, {"join_type": "JOIN", "left_source_id": "src1", "right_source_id": "src3", "join_conditions": [{"left_source_id": "src1", "left_column": "AGRMNT_ID", "operator": "=", "right_source_id": "src3", "right_column": "AGRMNT_ID"}]}, {"join_type": "LEFT JOIN", "left_source_id": "src1", "right_source_id": "src4", "join_conditions": [{"left_source_id": "src1", "left_column": "AGRMNT_ID", "operator": "=", "right_source_id": "src4", "right_column": "AGRMNT_ID"}]}, {"join_type": "LEFT JOIN", "left_source_id": "src1", "right_source_id": "src5", "join_conditions": [{"left_source_id": "src1", "left_column": "AGRMNT_ID", "operator": "=", "right_source_id": "src5", "right_column": "AGRMNT_ID"}]}, {"join_type": "LEFT JOIN", "left_source_id": "src1", "right_source_id": "src4", "join_conditions": [{"left_source_id": "src1", "left_column": "ORIGNL_AGRMNT_ID", "operator": "=", "right_source_id": "src4", "right_column": "AGRMNT_ID"}]}, {"join_type": "LEFT JOIN", "left_source_id": "src1", "right_source_id": "src5", "join_conditions": [{"left_source_id": "src1", "left_column": "ORIGNL_AGRMNT_ID", "operator": "=", "right_source_id": "src5", "right_column": "AGRMNT_ID"}]}], "filters": [{"clause": "WHERE", "filter_expression": "AGRMNT_RLTNSP_SEQUNC_NO IS NOT NULL", "involved_columns": [{"source_id": "src1", "column_name": "AGRMNT_RLTNSP_SEQUNC_NO"}]}, {"clause": "WHERE", "filter_expression": "AGRMNT_RLTNSP_SEQUNC_NO = 1", "involved_columns": [{"source_id": "src1", "column_name": "AGRMNT_RLTNSP_SEQUNC_NO"}]}]}, {"s_id": "s6", "statement_type": "INSERT", "target_table": {"database_name": "CC_COBRA", "schema_name": null, "table_name": "CC_AGREEMENT_ADDED_DATE", "alias": null, "inferred_target_type": "BASE_TABLE"}, "sources": [{"source_id": "src1", "database_name": "GDW_VIEWSX", "schema_name": null, "table_name": "CREDIT_CARD_AGREEMENT", "alias": "A", "source_type": "BASE_TABLE"}, {"source_id": "src2", "database_name": "CC_COBRA", "schema_name": null, "table_name": "WK_CC_AGREEMENT_ADDED_DT_T1", "alias": "B", "source_type": "WORK_TABLE"}, {"source_id": "src3", "database_name": "GRIDX_DV_RETAIL", "schema_name": null, "table_name": "AGREEMENT_STATIC", "alias": "AST", "source_type": "BASE_TABLE"}, {"source_id": "src4", "database_name": "CC_COBRA_VIEWS", "schema_name": null, "table_name": "VW_CC_MIGRATION_ACCOUNTS", "alias": "M", "source_type": "BASE_TABLE"}, {"source_id": "src5", "database_name": "CC_COBRA", "schema_name": null, "table_name": "CC_AGREEMENT_ADDED_DATE", "alias": "B", "source_type": "BASE_TABLE"}], "column_lineage": [{"output_column_name": "ORG_TX", "output_column_ordinal": 1, "transformation_logic": "B.ORG_TX", "source_references": [{"source_id": "src2", "column_name": "ORG_TX"}]}, {"output_column_name": "V_ORG", "output_column_ordinal": 2, "transformation_logic": "B.V_ORG", "source_references": [{"source_id": "src2", "column_name": "V_ORG"}]}, {"output_column_name": "AGRMNT_ID", "output_column_ordinal": 3, "transformation_logic": "A.AGRMNT_ID", "source_references": [{"source_id": "src1", "column_name": "AGRMNT_ID"}]}, {"output_column_name": "ORIGNL_AGRMNT_ID", "output_column_ordinal": 4, "transformation_logic": "A.AGRMNT_ID", "source_references": [{"source_id": "src1", "column_name": "AGRMNT_ID"}]}, {"output_column_name": "AGRMNT_RLTNSP_SEQUNC_NO", "output_column_ordinal": 5, "transformation_logic": "0", "source_references": []}, {"output_column_name": "CREDIT_CARD_LOGO_CD", "output_column_ordinal": 6, "transformation_logic": "B.CREDIT_CARD_LOGO_CD", "source_references": [{"source_id": "src2", "column_name": "CREDIT_CARD_LOGO_CD"}]}, {"output_column_name": "ADDED_DT", "output_column_ordinal": 7, "transformation_logic": "COALESCE(M.ACC_BUILD_DT,B.ADDED_DT)", "source_references": [{"source_id": "src4", "column_name": "ACC_BUILD_DT"}, {"source_id": "src2", "column_name": "ADDED_DT"}]}, {"output_column_name": "ORIGNL_ADDED_DT", "output_column_ordinal": 8, "transformation_logic": "COALESCE(M.ACC_OPEN_DT,B.ADDED_DT)", "source_references": [{"source_id": "src4", "column_name": "ACC_OPEN_DT"}, {"source_id": "src2", "column_name": "ADDED_DT"}]}, {"output_column_name": "OPENED_DT", "output_column_ordinal": 9, "transformation_logic": "B.OPENED_DT", "source_references": [{"source_id": "src2", "column_name": "OPENED_DT"}]}, {"output_column_name": "PURGED_DT", "output_column_ordinal": 10, "transformation_logic": "B.PURGED_DT", "source_references": [{"source_id": "src2", "column_name": "PURGED_DT"}]}, {"output_column_name": "AGRMNT_SELLNG_SORT_CD", "output_column_ordinal": 11, "transformation_logic": "AST.AGRMNT_SELLNG_SORT_CD", "source_references": [{"source_id": "src3", "column_name": "AGRMNT_SELLNG_SORT_CD"}]}, {"output_column_name": "MAC_CD", "output_column_ordinal": 12, "transformation_logic": "AST.MAC_CD", "source_references": [{"source_id": "src3", "column_name": "MAC_CD"}]}, {"output_column_name": "AGRMNT_SELLNG_CHANNL_CD", "output_column_ordinal": 13, "transformation_logic": "AST.AGRMNT_SELLNG_CHANNL_CD", "source_references": [{"source_id": "src3", "column_name": "AGRMNT_SELLNG_CHANNL_CD"}]}, {"output_column_name": "ORIGNL_AGRMNT_SELLNG_SORT_CD", "output_column_ordinal": 14, "transformation_logic": "AST.AGRMNT_SELLNG_SORT_CD", "source_references": [{"source_id": "src3", "column_name": "AGRMNT_SELLNG_SORT_CD"}]}, {"output_column_name": "ORIGNL_MAC_CD", "output_column_ordinal": 15, "transformation_logic": "AST.MAC_CD", "source_references": [{"source_id": "src3", "column_name": "MAC_CD"}]}, {"output_column_name": "ORIGNL_AGRMNT_SELLNG_CHANNL_CD", "output_column_ordinal": 16, "transformation_logic": "AST.AGRMNT_SELLNG_CHANNL_CD", "source_references": [{"source_id": "src3", "column_name": "AGRMNT_SELLNG_CHANNL_CD"}]}], "joins": [{"join_type": "JOIN", "left_source_id": "src1", "right_source_id": "src2", "join_conditions": [{"left_source_id": "src1", "left_column": "AGRMNT_ID", "operator": "=", "right_source_id": "src2", "right_column": "AGRMNT_ID"}]}, {"join_type": "LEFT JOIN", "left_source_id": "src1", "right_source_id": "src3", "join_conditions": [{"left_source_id": "src1", "left_column": "AGRMNT_ID", "operator": "=", "right_source_id": "src3", "right_column": "AGRMNT_ID"}]}, {"join_type": "LEFT JOIN", "left_source_id": "src1", "right_source_id": "src4", "join_conditions": [{"left_source_id": "src1", "left_column": "AGRMNT_ID", "operator": "=", "right_source_id": "src4", "right_column": "AGRMNT_ID"}]}], "filters": [{"clause": "WHERE", "filter_expression": "NOT EXISTS (SELECT NULL FROM CC_COBRA.CC_AGREEMENT_ADDED_DATE B WHERE A.AGRMNT_ID = B.AGRMNT_ID)", "involved_columns": [{"source_id": "src1", "column_name": "AGRMNT_ID"}, {"source_id": "src5", "column_name": "AGRMNT_ID"}]}, {"clause": "WHERE", "filter_expression": "A.SOURCE_END_DT = '3500/12/31'", "involved_columns": [{"source_id": "src1", "column_name": "SOURCE_END_DT"}]}]}, {"s_id": "s7", "statement_type": "UPDATE", "target_table": {"database_name": "CC_COBRA", "schema_name": null, "table_name": "CC_AGREEMENT_ADDED_DATE", "alias": null, "inferred_target_type": "BASE_TABLE"}, "sources": [{"source_id": "src1", "database_name": "GDW_VIEWSX", "schema_name": null, "table_name": "CREDIT_CARD_AGREEMENT", "alias": "CAK", "source_type": "BASE_TABLE"}, {"source_id": "src2", "database_name": "GRIDX_DV_RETAIL", "schema_name": null, "table_name": "AGREEMENT_STATIC", "alias": "B", "source_type": "BASE_TABLE"}, {"source_id": "src3", "database_name": "GDW_VIEWSX", "schema_name": null, "table_name": "AGREEMENT_OFFER_MANAGER", "alias": "AOM", "source_type": "BASE_TABLE"}, {"source_id": "src4", "database_name": "GDW_VIEWSX", "schema_name": null, "table_name": "AGREEMENT_CC_MAC", "alias": "ACM", "source_type": "BASE_TABLE"}, {"source_id": "src5", "database_name": "GDW_VIEWS", "schema_name": null, "table_name": "OU_STRUCTURE_SORTCODE_GL", "alias": "CHC", "source_type": "BASE_TABLE"}], "column_lineage": [{"output_column_name": "AGRMNT_SELLNG_SORT_CD", "output_column_ordinal": null, "transformation_logic": "T1.AGRMNT_SELLNG_SORT_CD", "source_references": [{"source_id": "src3", "column_name": "SELLNG_BRANCH_SORT_CD"}]}, {"output_column_name": "MAC_CD", "output_column_ordinal": null, "transformation_logic": "T1.MAC_CD", "source_references": [{"source_id": "src4", "column_name": "MAC_CD"}]}, {"output_column_name": "AGRMNT_SELLNG_CHANNL_CD", "output_column_ordinal": null, "transformation_logic": "T1.AGRMNT_SELLNG_CHANNL_CD", "source_references": [{"source_id": "src5", "column_name": "CHANNL_CD"}]}, {"output_column_name": "ORIGNL_AGRMNT_SELLNG_SORT_CD", "output_column_ordinal": null, "transformation_logic": "T1.AGRMNT_SELLNG_SORT_CD", "source_references": [{"source_id": "src3", "column_name": "SELLNG_BRANCH_SORT_CD"}]}, {"output_column_name": "ORIGNL_MAC_CD", "output_column_ordinal": null, "transformation_logic": "T1.MAC_CD", "source_references": [{"source_id": "src4", "column_name": "MAC_CD"}]}, {"output_column_name": "ORIGNL_AGRMNT_SELLNG_CHANNL_CD", "output_column_ordinal": null, "transformation_logic": "T1.AGRMNT_SELLNG_CHANNL_CD", "source_references": [{"source_id": "src5", "column_name": "CHANNL_CD"}]}], "joins": [{"join_type": "LEFT OUTER JOIN", "left_source_id": "src1", "right_source_id": "src3", "join_conditions": [{"left_source_id": "src1", "left_column": "AGRMNT_ID", "operator": "=", "right_source_id": "src3", "right_column": "AGRMNT_ID"}]}, {"join_type": "INNER JOIN", "left_source_id": "src4", "right_source_id": "src1", "join_conditions": [{"left_source_id": "src1", "left_column": "AGRMNT_ID", "operator": "=", "right_source_id": "src4", "right_column": "AGRMNT_ID"}]}, {"join_type": "LEFT OUTER JOIN", "left_source_id": "src1", "right_source_id": "src4", "join_conditions": [{"left_source_id": "src1", "left_column": "AGRMNT_ID", "operator": "=", "right_source_id": "src4", "right_column": "AGRMNT_ID"}]}, {"join_type": "LEFT OUTER JOIN", "left_source_id": "src3", "right_source_id": "src5", "join_conditions": [{"left_source_id": "src3", "left_column": "SELLNG_BRANCH_SORT_CD", "operator": "=", "right_source_id": "src5", "right_column": "SORT_CD"}]}], "filters": [{"clause": "WHERE", "filter_expression": "NOT EXISTS (SELECT 'Y' FROM GRIDX_DV_RETAIL.AGREEMENT_STATIC B WHERE A.AGRMNT_ID = B.AGRMNT_ID)", "involved_columns": [{"source_id": "src1", "column_name": "AGRMNT_ID"}, {"source_id": "src2", "column_name": "AGRMNT_ID"}]}, {"clause": "WHERE", "filter_expression": "A.SOURCE_END_DT = '3500/12/31'", "involved_columns": [{"source_id": "src1", "column_name": "SOURCE_END_DT"}]}, {"clause": "ON", "filter_expression": "AOM.OFFER_ID_TX IN ('NEWACC','005Z0NEW  ')", "involved_columns": [{"source_id": "src3", "column_name": "OFFER_ID_TX"}]}, {"clause": "ON", "filter_expression": "AOM.SOURCE_END_DT = '3500/12/31'", "involved_columns": [{"source_id": "src3", "column_name": "SOURCE_END_DT"}]}, {"clause": "WHERE", "filter_expression": "NEW_MAC_TYPE_IN = 'Y'", "involved_columns": [{"source_id": "src4", "column_name": "NEW_MAC_TYPE_IN"}]}, {"clause": "ON", "filter_expression": "CAK.SOURCE_END_DT = '3500/12/31'", "involved_columns": [{"source_id": "src1", "column_name": "SOURCE_END_DT"}]}, {"clause": "ON", "filter_expression": "WK_MAC.MAC_SEQ = 1", "involved_columns": []}, {"clause": "WHERE", "filter_expression": "CC_COBRA.CC_AGREEMENT_ADDED_DATE.AGRMNT_ID = T1.AGRMNT_ID", "involved_columns": [{"source_id": "target", "column_name": "AGRMNT_ID"}, {"source_id": "src1", "column_name": "AGRMNT_ID"}]}]}, {"s_id": "s8", "statement_type": "UPDATE", "target_table": {"database_name": "CC_COBRA", "schema_name": null, "table_name": "CC_AGREEMENT_ADDED_DATE", "alias": null, "inferred_target_type": "BASE_TABLE"}, "sources": [{"source_id": "src1", "database_name": "CC_COBRA", "schema_name": null, "table_name": "CC_AGREEMENT_ADDED_DATE", "alias": "A", "source_type": "BASE_TABLE"}, {"source_id": "src2", "database_name": "CC_COBRA", "schema_name": null, "table_name": "CC_AGREEMENT_ADDED_DATE", "alias": "B", "source_type": "BASE_TABLE"}], "column_lineage": [{"output_column_name": "ORIGNL_AGRMNT_SELLNG_SORT_CD", "output_column_ordinal": null, "transformation_logic": "T1.ORIGNL_AGRMNT_SELLNG_SORT_CD", "source_references": [{"source_id": "src2", "column_name": "ORIGNL_AGRMNT_SELLNG_SORT_CD"}]}, {"output_column_name": "ORIGNL_MAC_CD", "output_column_ordinal": null, "transformation_logic": "T1.ORIGNL_MAC_CD", "source_references": [{"source_id": "src2", "column_name": "ORIGNL_MAC_CD"}]}, {"output_column_name": "ORIGNL_AGRMNT_SELLNG_CHANNL_CD", "output_column_ordinal": null, "transformation_logic": "T1.ORIGNL_AGRMNT_SELLNG_CHANNL_CD", "source_references": [{"source_id": "src2", "column_name": "ORIGNL_AGRMNT_SELLNG_CHANNL_CD"}]}], "joins": [{"join_type": "JOIN", "left_source_id": "src1", "right_source_id": "src2", "join_conditions": [{"left_source_id": "src1", "left_column": "ORIGNL_AGRMNT_ID", "operator": "=", "right_source_id": "src2", "right_column": "ORIGNL_AGRMNT_ID"}]}], "filters": [{"clause": "ON", "filter_expression": "B.ORIGNL_AGRMNT_ID = B.AGRMNT_ID", "involved_columns": [{"source_id": "src2", "column_name": "ORIGNL_AGRMNT_ID"}, {"source_id": "src2", "column_name": "AGRMNT_ID"}]}, {"clause": "ON", "filter_expression": "A.ORIGNL_AGRMNT_ID <> A.AGRMNT_ID", "involved_columns": [{"source_id": "src1", "column_name": "ORIGNL_AGRMNT_ID"}, {"source_id": "src1", "column_name": "AGRMNT_ID"}]}, {"clause": "WHERE", "filter_expression": "CC_COBRA.CC_AGREEMENT_ADDED_DATE.AGRMNT_ID = T1.AGRMNT_ID", "involved_columns": [{"source_id": "target", "column_name": "AGRMNT_ID"}, {"source_id": "src1", "column_name": "AGRMNT_ID"}]}]}, {"s_id": "s9", "statement_type": "DELETE", "target_table": {"database_name": "CC_COBRA", "schema_name": null, "table_name": "WK_CC_AGREEMENT_ADDED_DT_T1", "alias": null, "inferred_target_type": "WORK_TABLE"}, "sources": [], "column_lineage": [], "joins": [], "filters": [{"clause": "WHERE", "filter_expression": "ALL", "involved_columns": []}]}, {"s_id": "s10", "statement_type": "UPDATE", "target_table": {"database_name": "CC_COBRA", "schema_name": null, "table_name": "CC_COBRA_LOAD_LOG", "alias": null, "inferred_target_type": "LOG_TABLE"}, "sources": [{"source_id": "src1", "database_name": "CC_COBRA", "schema_name": null, "table_name": "CC_COBRA_LOAD_START_DT", "alias": null, "source_type": "BASE_TABLE"}], "column_lineage": [{"output_column_name": "CURRENT_LOAD_DT", "output_column_ordinal": null, "transformation_logic": "(SELECT START_DT FROM CC_COBRA.CC_COBRA_LOAD_START_DT)", "source_references": [{"source_id": "src1", "column_name": "START_DT"}]}, {"output_column_name": "CURRENT_BUS_DT", "output_column_ordinal": null, "transformation_logic": "(SELECT SOURCE_START_DT FROM CC_COBRA.CC_COBRA_LOAD_START_DT)", "source_references": [{"source_id": "src1", "column_name": "SOURCE_START_DT"}]}, {"output_column_name": "UPDATE_DT", "output_column_ordinal": null, "transformation_logic": "DATE", "source_references": []}, {"output_column_name": "UPDATE_TM", "output_column_ordinal": null, "transformation_logic": "TIME", "source_references": []}, {"output_column_name": "LOAD_STATUS", "output_column_ordinal": null, "transformation_logic": "'C'", "source_references": []}], "joins": [], "filters": [{"clause": "WHERE", "filter_expression": "GRID_LOAD_ID = 'C01J02'", "involved_columns": [{"source_id": "target", "column_name": "GRID_LOAD_ID"}]}]}, {"s_id": "s11", "statement_type": "UPDATE", "target_table": {"database_name": "CC_COBRA", "schema_name": null, "table_name": "CC_COBRA_LOAD_LOG", "alias": null, "inferred_target_type": "LOG_TABLE"}, "sources": [], "column_lineage": [{"output_column_name": "LOAD_STATUS", "output_column_ordinal": null, "transformation_logic": "'F'", "source_references": []}], "joins": [], "filters": [{"clause": "WHERE", "filter_expression": "GRID_LOAD_ID = 'C01J02'", "involved_columns": [{"source_id": "target", "column_name": "GRID_LOAD_ID"}]}]}]}